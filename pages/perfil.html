<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mi Perfil</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-6 max-w-4xl">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold">Mi Cuenta</h1>
            <a href="index.html" class="text-blue-600 hover:underline">Volver a Tienda</a>
        </div>
        <div class="bg-white p-6 rounded-xl shadow mb-6" id="user-info"></div>
        <div class="bg-white p-6 rounded-xl shadow overflow-y-auto max-h-96">
            <h2 class="text-xl font-bold mb-4">Mis Pedidos</h2>
            <div id="lista-pedidos" class="space-y-4"></div>
        </div>
    </div>
    <script>
        const user = JSON.parse(localStorage.getItem('usuarioSesion'));
        if (!user) window.location.href = 'auth.html';
        
        document.getElementById('user-info').innerHTML = `
            <p class="text-lg"><strong>Hola,</strong> ${user.nombre}</p>
            <p class="text-gray-600">${user.email}</p>
        `;

        const todos = JSON.parse(localStorage.getItem('pedidos')) || [];
        const misPedidos = todos.filter(p => p.usuarioEmail === user.email);
        const div = document.getElementById('lista-pedidos');
        
        if(misPedidos.length === 0) div.innerHTML = '<p class="text-gray-400">Sin pedidos.</p>';
        
        misPedidos.reverse().forEach(p => {
            div.innerHTML += `
                <div class="border p-4 rounded hover:bg-gray-50 flex justify-between items-center">
                    <div>
                        <span class="font-bold">#${p.id}</span>
                        <p class="text-sm text-gray-500">${p.fecha} - ${p.items.length} productos</p>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-green-600">$${p.total}</p>
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${p.estado}</span>
                    </div>
                </div>`;
        });
    </script>
</body>
</html>